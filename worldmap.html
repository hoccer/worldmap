<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>index</title>
	<meta name="author" content="Robert Palmer">
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
  <script src="lib/socketio/socket.io.js" type="text/javascript" charset="utf-8"></script>
  <script type="text/javascript" charset="utf-8">
    function initialize() {
      var latlng = new google.maps.LatLng(-34.397, 150.644),
          berlin = new google.maps.LatLng(52.5167780325, 13.409039925);
      
      var myOptions = {
        zoom: 2,
        center: berlin,
        mapTypeId: google.maps.MapTypeId.ROADMAP
      };
      var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
      
      addMarker(map, berlin.lat(), berlin.lng());
      
      socket = new io.Socket('localhost', { port: 8080 });
      socket.connect();

      socket.on('message', function(data){          
          addMarker(map, data.longitude, data.latitude);
      });
    }
    
    var addMarker = function(map, latitude, longitude) {
      var marker = new google.maps.Marker({
        map: map,
        draggable: true,
        animation: google.maps.Animation.DROP
      });
      marker.setPosition(new google.maps.LatLng(latitude, longitude));
      
      setTimeout(function() {
        marker.setMap(null);
      }, 2000);	
    }
    
  </script>
  <style type="text/css" media="screen">
    html { width: 100%; height: 100%; }
    body { 
      width: 100%; height: 100%; 
      padding: 0; margin: 0;
    }

    #map_canvas {
      width: 100%; height: 100%;
    }
  </style>
</head>
<body onload="initialize()">
  <div id="map_canvas"></div>
</body>
</html>
